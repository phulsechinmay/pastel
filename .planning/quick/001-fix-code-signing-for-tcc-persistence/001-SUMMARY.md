---
phase: quick
plan: 001
subsystem: infra
tags: [code-signing, xcode, tcc, accessibility, xcodegen]

# Dependency graph
requires:
  - phase: 03-paste-back-and-hotkeys
    provides: "Accessibility permission requirement for paste-back"
provides:
  - "Stable binary identity for macOS TCC permission persistence"
  - "Automatic code signing with Apple Development certificate"
affects: []

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Automatic code signing with team ID in project.yml"

key-files:
  created: []
  modified:
    - project.yml
    - Pastel.xcodeproj/project.pbxproj

key-decisions:
  - "Apple Development certificate signing (not ad-hoc) for stable CDHash"
  - "DEVELOPMENT_TEAM hardcoded in project.yml (single developer project)"

patterns-established:
  - "Automatic signing: all signing config lives in project.yml, regenerated via xcodegen"

# Metrics
duration: 1min
completed: 2026-02-06
---

# Quick Task 001: Fix Code Signing for TCC Persistence Summary

**Automatic code signing with Apple Development certificate so macOS TCC persists Accessibility permission across Xcode rebuilds**

## Performance

- **Duration:** 1 min
- **Started:** 2026-02-06T23:51:30Z
- **Completed:** 2026-02-06T23:52:38Z
- **Tasks:** 1
- **Files modified:** 2

## Accomplishments
- Replaced ad-hoc signing (`CODE_SIGN_IDENTITY: "-"`) with automatic signing using Apple Development certificate
- Binary now carries stable CDHash tied to team QLSJ39DRSH, so macOS TCC tracks Accessibility permission across rebuilds
- Verified build succeeds with `Authority=Apple Development` and correct team identifier

## Task Commits

Each task was committed atomically:

1. **Task 1: Update project.yml signing configuration and regenerate Xcode project** - `2106f94` (fix)

## Files Created/Modified
- `project.yml` - Replaced `CODE_SIGN_IDENTITY: "-"` with `CODE_SIGN_STYLE: Automatic`, `DEVELOPMENT_TEAM: QLSJ39DRSH`, `CODE_SIGN_IDENTITY: "Apple Development"`
- `Pastel.xcodeproj/project.pbxproj` - Regenerated by xcodegen with new signing settings

## Decisions Made
- Used `DEVELOPMENT_TEAM: QLSJ39DRSH` hardcoded in project.yml since this is a single-developer project
- Kept entitlements as empty dict (no sandbox) -- required for unsandboxed paste-back via CGEvent

## Deviations from Plan
None - plan executed exactly as written.

## Issues Encountered
None.

## User Setup Required
None - no external service configuration required.

## Verification Results
- `xcodegen generate` succeeded
- `xcodebuild build` succeeded (BUILD SUCCEEDED)
- `codesign -dvvv` confirmed:
  - Authority: Apple Development: phulsechinmay@gmail.com (99Q284DZ88)
  - TeamIdentifier: QLSJ39DRSH
  - CDHash: 3ddc319c5ead4e3c1739e81fe24833bafa370ace
- Entitlements: only `com.apple.security.get-task-allow` (Xcode debug default, no sandbox)

---
*Quick task: 001-fix-code-signing-for-tcc-persistence*
*Completed: 2026-02-06*
